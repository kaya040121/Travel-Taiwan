{"version":3,"sources":["all.js"],"names":["swiper","Swiper","pagination","el","data","popularList","document","querySelector","citySelect","categorySelect","search","list","ScenicSpotCategory","getAllScenicSpot","axios","get","headers","getAuthorizationHeader","then","response","thisData","forEach","item","Class1","undefined","renderCategory","error","console","log","ScenicSpotCategoryAry","Object","keys","str","optionAll","innerHTML","init","getTourList","renderScenicSpot","Picture","PictureUrl1","push","ScenicSpotName","OpenTime","Address","addEventListener","e","city","value","category","AppID","AppKey","GMTString","Date","toGMTString","ShaObj","jsSHA","setHMACKey","update","HMAC","getHMAC","Authorization"],"mappings":"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","file":"all.js","sourcesContent":["// Initialize Swiper\nvar swiper = new Swiper(\".mySwiper\", {\n  pagination: {\n    el: \".swiper-pagination\",\n  },\n});\n\n\n// axios 取得全台旅遊景點資料\n// console.log(getAuthorizationHeader());\n\nlet data = [];\n\n// DOM\n// index\nconst popularList = document.querySelector('.js-popularList');\nconst citySelect = document.querySelector('.js-citySelect');\nconst categorySelect = document.querySelector('.js-categorySelect');\nconst search = document.querySelector('.js-search');\n// attraction\nconst list = document.querySelector('.js-list');\n\n// 整理資料 - 景點類別\nconst ScenicSpotCategory = {};\nfunction getAllScenicSpot() {\n  axios.get('https://ptx.transportdata.tw/MOTC/v2/Tourism/ScenicSpot/NewTaipei?%24format=JSON', {\n    headers: getAuthorizationHeader()\n  })\n    .then(function (response) {\n      // console.log(response.data);\n      let thisData = response.data;\n      // 整理建立類別，並統計各類別數量\n      thisData.forEach(function (item) {\n        // 濾掉沒有 Class1\n        if (item.Class1 === undefined) {\n          // console.log(\"類別為 undefined\");\n          return;\n        } else if (ScenicSpotCategory[item.Class1] === undefined) {\n          ScenicSpotCategory[item.Class1] = 1;\n        } else {\n          ScenicSpotCategory[item.Class1] += 1;\n        }\n      })\n      // console.log(ScenicSpotCategory);\n      renderCategory();\n    })\n    .catch(function (error) {\n      console.log(error);\n    })\n}\ngetAllScenicSpot();\n\nfunction renderCategory() {\n  const ScenicSpotCategoryAry = Object.keys(ScenicSpotCategory);\n  // console.log(ScenicSpotCategoryAry);\n  let str = \"\";\n  ScenicSpotCategoryAry.forEach(function (item) {\n    str += `<option value=\"${item}\">${item}</option>`;\n  })\n  let optionAll = `<option selected value=\"所有類別\">所有類別</option>`;\n  str = optionAll + str;\n  // console.log(str);\n  categorySelect.innerHTML = str;\n}\n\n// index 載入初始化\nfunction init() {\n  getTourList();\n}\ninit();\n\n// 取得所有旅遊景點\nfunction getTourList() {\n  axios.get('https://ptx.transportdata.tw/MOTC/v2/Tourism/ScenicSpot?%24top=40&%24format=JSON', {\n    headers: getAuthorizationHeader()\n  })\n    .then(function (response) {\n      console.log(response.data);\n      renderScenicSpot(response); // 渲染\n    })\n    .catch(function (error) {\n      console.log(error);\n    })\n}\n\n// 渲染景點資訊 - index\nfunction renderScenicSpot(response) {\n  data = []; // 清空 data 陣列\n  // 將沒有圖片的資料加上預設圖片\n  response.data.forEach(function (item) {\n    if (item.Picture.PictureUrl1 === undefined) {\n      item.Picture.PictureUrl1 = \"https://upload.cc/i1/2021/12/03/KirL4h.jpg\";\n    }\n    data.push(item); // 將整理過的資料推入 data 陣列\n  })\n  // 組字串\n  let str = \"\";\n  data.forEach(function (item) {\n    str += `\n        <li class=\"col-lg-3 mb-18\">\n          <div class=\"card shadow\" style=\"height: 100%;\">\n            <img src=\"${item.Picture.PictureUrl1}\" class=\"card-img-top\" alt=\"${item.ScenicSpotName}\">\n            <div class=\"card-body pt-9 pb-7 d-flex flex-column\">\n              <h4 class=\"card-title mb-4 fw-bold me-1\">${item.ScenicSpotName}</h5>\n                <p class=\"card-text text-info fw-light font-size-xxs mb-1\"><i\n                    class=\"far fa-clock me-1\"></i>${item.OpenTime}</p>\n                <p class=\"mb-4 text-info fs-5\"><i class=\"fas fa-map-marker-alt text-primary me-1\"></i>${item.Address}\n                </p>\n                <div class=\"d-grid col-8 mx-auto mt-auto\">\n                  <!-- Button trigger modal -->\n                  <button type=\"button\" class=\"btn btn-outline-primary border-4 fw-bold fs-6 text-nowrap\"\n                    data-bs-toggle=\"modal\" data-bs-target=\"#exampleModal\">\n                    了解更多\n                  </button>\n                </div>\n            </div>\n          </div>\n        </li>        \n        `;\n  })\n  popularList.innerHTML = str;\n}\n\n// 監聽篩選景點 - index\nsearch.addEventListener('click', function (e) {\n  const city = citySelect.value;\n  const category = categorySelect.value;\n  console.log(category, city);\n  // https://ptx.transportdata.tw/MOTC/v2/Tourism/ScenicSpot?%24filter=contains(Class1,'遊憩類')&%24top=30&%24format=JSON\n  // 跳轉至 attraction.html\n  // document.location.href = \"/attractions.html\" + `?city=${city}`;\n  if (city == \"所有縣市\" && category == \"所有類別\") {\n    // 取得所有縣市+所有類別資料\n    axios.get(\n      `https://ptx.transportdata.tw/MOTC/v2/Tourism/ScenicSpot?%24top=40&%24format=JSON`,\n      {\n        headers: getAuthorizationHeader()\n      }\n    )\n      .then(function (response) {\n        console.log(response.data);\n        renderScenicSpot(response);\n      })\n      .catch(function (error) {\n        console.log(error);\n      })\n    return;\n  }\n  else if (city == \"所有縣市\" && category !== \"所有類別\") {\n    axios.get(\n      `https://ptx.transportdata.tw/MOTC/v2/Tourism/ScenicSpot?%24filter=contains(Class1,'${category}')&%24top=40&%24format=JSON`,\n      {\n        headers: getAuthorizationHeader()\n      }\n    )\n      .then(function (response) {\n        console.log(response.data);\n        renderScenicSpot(response);\n      })\n      .catch(function (error) {\n        console.log(error);\n      })\n    return;\n  }\n  else if (city !== \"所有縣市\" && category == \"所有類別\") {\n    axios.get(\n      `https://ptx.transportdata.tw/MOTC/v2/Tourism/ScenicSpot/${city}?%24top=40&%24format=JSON`,\n      {\n        headers: getAuthorizationHeader()\n      }\n    )\n      .then(function (response) {\n        console.log(response.data);\n        renderScenicSpot(response);\n      })\n      .catch(function (error) {\n        console.log(error);\n      })\n    return;\n  }\n  else if (city !== \"所有縣市\" && category !== \"所有類別\") {\n    axios.get(\n      `https://ptx.transportdata.tw/MOTC/v2/Tourism/ScenicSpot/${city}?%24filter=contains(Class1%2C'${category}')&%24top=40&%24format=JSON`,\n      {\n        headers: getAuthorizationHeader()\n      }\n    )\n      .then(function (response) {\n        console.log(response.data);\n        renderScenicSpot(response);\n      })\n      .catch(function (error) {\n        console.log(error);\n      })\n    return;\n  }\n})\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// axios.get(\n//   'https://ptx.transportdata.tw/MOTC/v2/Tourism/ScenicSpot?%24top=30&%24format=JSON',\n//   {\n//     headers: getAuthorizationHeader()\n//   }\n// )\n//   .then(function (response) {\n//     // 將 response.data 渲染文字在 body 標籤，將原本的 JSON 格式轉為字串。\n//     // document.querySelector('body').textContent = JSON.stringify(response.data);\n//     console.log(response.data);\n//   })\n//   .catch(function (error) {\n//     console.log(error);\n//   });\n\n// 驗證\nfunction getAuthorizationHeader() {\n  //  填入自己 ID、KEY 開始\n  let AppID = '2f697d094fc54340a7c751bfaf561119';\n  let AppKey = '4j3yln6jQtVhiggEXxHFHc5yzy0';\n  //  填入自己 ID、KEY 結束\n  let GMTString = new Date().toGMTString();\n  let ShaObj = new jsSHA('SHA-1', 'TEXT');\n  ShaObj.setHMACKey(AppKey, 'TEXT');\n  ShaObj.update('x-date: ' + GMTString);\n  let HMAC = ShaObj.getHMAC('B64');\n  let Authorization = 'hmac username=\\\"' + AppID + '\\\", algorithm=\\\"hmac-sha1\\\", headers=\\\"x-date\\\", signature=\\\"' + HMAC + '\\\"';\n  return { 'Authorization': Authorization, 'X-Date': GMTString };\n}\n\n"]}